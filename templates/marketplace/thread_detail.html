{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Messages" %}{% endblock %}

{% block content %}
<h1>{% trans "Conversation" %}</h1>
<p class="helptext">
    {% trans "Regarding:" %}
    {% if user.role == "buyer" %}
        <strong>{{ thread.match.supply_lot.item_text }}</strong>
    {% else %}
        <strong>{{ thread.match.demand_post.item_text }}</strong>
    {% endif %}
</p>

<div class="messages-list">
    {% for msg in messages_list %}
    <div class="message {% if msg.sender == user %}sent{% else %}received{% endif %}">
        <strong>{{ msg.sender.email }}</strong>
        <span>{{ msg.created_at|date:"SHORT_DATETIME_FORMAT" }}</span>
        <p>{{ msg.body }}</p>
    </div>
    {% empty %}
    <p class="empty-state">{% trans "No messages yet. Start the conversation!" %}</p>
    {% endfor %}
</div>

<div class="card">
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">{% trans "Send" %}</button>
    </form>
</div>

<div class="actions">
    <a href="{% url 'marketplace:match_list' %}" class="btn btn-secondary">{% trans "Back to matches" %}</a>
</div>
{% endblock %}
