{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Dashboard" %}{% endblock %}

{% block content %}
<h1>{% trans "Dashboard" %}</h1>

{% if user.role == "buyer" %}
    <section>
        <h2>{% trans "Your Demand Posts" %}</h2>
        {% if demand_posts %}
        <ul class="item-list">
            {% for post in demand_posts %}
            <li>
                <a href="{% url 'marketplace:demand_post_detail' post.pk %}">{{ post.item_text }}</a>
                <span class="status status-{{ post.status }}">{{ post.get_status_display }}</span>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="empty-state">{% trans "No demand posts yet." %}</p>
        {% endif %}
        <a href="{% url 'marketplace:demand_post_create' %}" class="btn btn-primary">{% trans "Create demand post" %}</a>
    </section>

    <section>
        <h2>{% trans "Recent Matches" %}</h2>
        {% if matches %}
        <ul class="item-list">
            {% for match in matches %}
            <li>
                <span>{{ match.supply_lot.item_text }}</span>
                <a href="{% url 'marketplace:thread_detail' match.thread.pk %}" class="btn btn-secondary btn-small">{% trans "Message" %}</a>
            </li>
            {% endfor %}
        </ul>
        <a href="{% url 'marketplace:match_list' %}">{% trans "View all matches" %}</a>
        {% else %}
        <p class="empty-state">{% trans "No matches yet." %}</p>
        {% endif %}
    </section>

{% else %}
    <section>
        <h2>{% trans "Your Supply Lots" %}</h2>
        {% if supply_lots %}
        <ul class="item-list">
            {% for lot in supply_lots %}
            <li>
                <a href="{% url 'marketplace:supply_lot_detail' lot.pk %}">{{ lot.item_text }}</a>
                <span class="status status-{{ lot.status }}">{{ lot.get_status_display }}</span>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="empty-state">{% trans "No supply lots yet." %}</p>
        {% endif %}
        <a href="{% url 'marketplace:supply_lot_create' %}" class="btn btn-primary">{% trans "Create supply lot" %}</a>
    </section>

    <section>
        <h2>{% trans "Recent Matches" %}</h2>
        {% if matches %}
        <ul class="item-list">
            {% for match in matches %}
            <li>
                <span>{{ match.demand_post.item_text }}</span>
                <a href="{% url 'marketplace:thread_detail' match.thread.pk %}" class="btn btn-secondary btn-small">{% trans "Message" %}</a>
            </li>
            {% endfor %}
        </ul>
        <a href="{% url 'marketplace:match_list' %}">{% trans "View all matches" %}</a>
        {% else %}
        <p class="empty-state">{% trans "No matches yet." %}</p>
        {% endif %}
    </section>
{% endif %}
{% endblock %}
